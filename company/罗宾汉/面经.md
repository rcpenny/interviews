https://drive.google.com/file/d/1J07FKBmkLgfGQNeSx34C09QE4aHa5Jtf/view

matrixQueries: 
给一个n * m的matrix m，index 从 1算起，m(i, j) = i *j
初始matrix中所有元素都是active的，再给二维数组 int queries[num][2]，queries代表一个操作命令，操作规则如下：
queries[0] == 0: 向输出数组中添加当前矩阵中所有active的元素的最小值
queries[0] == 1: 将行数为queries[1]的元素deactive
queries[0] == 2: 将列数为queries[1]的元素deactive
将num个query操作完成后，最后返回long[]型数组

1. process queries
Given an integer array (int[] a) and a 2D array(int[][] queries). The 2D array represents a set of queries. 
You need to process the queries to find the occurrence of a specific number in array a between index i and j(inclusive). Each query is formatted in the following way: Each query has size 3(query.length=3, 0<=i< queries.length) 
The first element is the lower index i. The second element is the higher index j and the third element is the number you are searching for. Return the sum of numbers of occurrences you get from processing all the queries. (Brute force solution will not be efficient enough to pass all test cases)

map<Integer List> numToAllIndexes;

bank transfer
http://web.mit.edu/6.005/www/fa15/classes/23-locks/#locking
1. 一段从账户取钱存到另一个账户的代码。
2. 问有什么问题。答：需要用transaction来解，细聊了一下transaction是怎么保证正确性的，transaction提交过程中发生的事。
第二题是转账的，账户A减少，账户B增加，要用transaction
第二题就是经典的DB transaction那题
def bad_transfer(src_account, dst_account, amount): 
    src_cash = src_account.cash # DB read
    dst_cash = dst_account.cash # DB read
    if src_cash < amount: 
        raise InsufficientFunds
    src_account.cash = src_cash - amount # DB write
    src_account.send_src_transfer_email()
    dst_account.cash = dst_cash + amount # DB write     
 
    dst_account.send_dst_transfer_email()

反正就是扯了一堆有的没‍‍‍‌‍‍‍‍‍‌‍‍‌‍‌‍‌‍‍的
为啥会有问题（口语捉急，解释了挺久的）最后写了一下代码举了例子。总体就是，在db read和db write之间，src_cash - amount可能就不再是src的值了，因为发生了别的tranfer，所以这两个read和write要锁在一起 （地里有些帖子的答案是错的 ）
 2. 问锁是application level的还是db level，顺便让我说一下db level的锁能够做啥。
 3. 问锁的是整个函数，还是单个变量。锁的是单个变量，如果锁了函数，那么就变成整个system串行了。
 4. 因为邮件的缘故，我提到了rollback，他就让我说一下为啥会rollback，然后假设这个函数包含一个transaction（或者一个transaction包含这函数），那么transaction的开始和结束再哪。
嗯。。这方面我就不太懂，我觉得写的时候应该是读不了的吧。除非写不是原子操作。
如果写不是原子操作 ...
对啊，写的时候加写锁，读的时候加读锁，这个没有什么可以疑问的啊？
我的意思是，读的时候一定要加锁，不然，你在读的同时，一个写锁上来，你读的数据就是一半是以前的，一半是之后的
LZ 第二题提到commit model就应该ok了
第二题的email在给sender发之前是不是应该先把receiver的钱弄好啊，万一发了之后crash，s‍‍‍‌‍‍‍‍‍‌‍‍‌‍‌‍‌‍‍ender发现自己钱被扣了但是receiver发现自己还没收到，虽说在系统和数据层面上没有影响，但是可能会影响到用户体验哈哈

给一段伪代码，‍‍‍‌‍‍‍‍‍‌‍‍‌‍‌‍‌‍‍从中找出可能的问题
伪代码做的事情是从srcAccount给dstAccount转账amount，大概是
function accountTransfer(srcAccount, dstAccount, amount)
  srcBalance = db.getBalance(srcAccount)
  if srcBalance >= amount:
    dstBalance = db.getBalance(dstAccount)
    db.setBalance(srcBalance - amount)
    sendEmailTo(srcAccount)
    db.setBalance(dstBalance + amount)
    sendEmailTo(dstAccount)

看看其他的robinhood面经 一模一样 注意的是 transaction那题 请务必搞明白多线程锁的实现 read write lock的code模版 写得要信手捏来 说得得有理有据 如果用数据库实现的话 就不需要自己来实现lock了 但是对于自己实现的话 样例代码就足够了 但要写得有理有据
其实我不知道。。。我就是说的database的transaction可以用来lock全局object感觉他还比较满意 不是很知道nosql


onsite
1. Design a Messaging App for Family,
- UI/UX, features
- How to store data
- Design APIs
- Android Architecture and Implementation
2. Implement an Android with an infinite list, each item has a counter and a button, it starts counting as long as the row is visible on screen. The button shows pause/play, tap on that will pause/continue the timer for that specific row.


onsite
10am 到下午 3pm，总共4轮。
第一轮：跟经理‍‍‍‌‍‍‍‍‍‌‍‍‌‍‌‍‌‍‍聊聊经验，没有coding
第二轮：跟一位前端工程师做题。内容是用create-react-app的模版来写一个模拟苹果spotlight search的react component。（感觉这一轮是我挂的主要原因，要很快的用电脑写出这个component，然后css比较像，还有autocomplete的功能（用一个已有的object里的字去autocomplete）。我写到最后autocomplete有点问题时间不够了。）
第三轮：leetcode 140 word break II但是只要return一个解法就好了
第四轮：聊关于怎么architect一个real-time messaging application，比如messenger

onsite
电面就一轮，面试官是我后来onsite的面试官。题目就是地里常见的面经，旋转打印矩阵，加上一个security方面的问题。楼主并没有被问到地里常见的那个多‍‍‍‌‍‍‍‍‍‌‍‍‌‍‌‍‌‍‍线程的问题，而是被问到了一个很类似PKI design的问题，感觉这里也是因为投的职位的原因，可能不那么具有参考性。
然后是onsite，四轮，一个下午就面完了。
第一轮的名字叫日志分析，给的一个json的input，每一行表示一些user登陆server的信息，要求处理json的数据，然后再设计一些security方面的分析，找出malicious user。这个是在coderpad上进行的，所以按理来说应该是要run出结果的。但是楼主用的是Java，一时半会实在不好处理json的数据，所以这一面并没有真正run出结果。根据后面recruiter的反馈，应该是fail在这里了，所以有相似的同学可以换成python。
第二轮叫scalable system，记忆已经比较模糊了，但是就是一个非常常见的分布式里的partition，replication之类的设计。
第三轮是coding，计算器，有括号，加和乘，但是有一个什么限制条件一下就把这题给变成了简单题，非常简单。最后要设计test case跑test。
第四轮architecture，主要就是讨论，一个API service的load banlancer后面会有很多个server，每个server都会有一个log，如何将这些log merge起来，并且设置monitor，alert之类的。楼主的答案是基于Kafka的。

onsite
总共4论， 每轮45 分钟， 分别是 behavior question, system design, codi‍‍‍‌‍‍‍‍‍‌‍‍‌‍‌‍‌‍‍ng (code quality), algorithm. coding第一轮是一个很简单的题， 要上ide 写， 主要考察code quality. 第二轮 coding 是算法，不用写代码， 基本上他出一个题我说思路， 总共面了三个题， 都挺简单的。求米求米
1.‍‍‍‌‍‍‍‍‍‌‍‍‌‍‌‍‌‍‍ 比赛配对，最远的两个配对，given even int n, output a string. ex 4 -> ((1, 4), (2,3))
2. sum of string
3. given an array, split it into two subarrays which don't contain any duplicate element and have same size
4. 忘了。。
限时1h10min，可以半小时解决
4. 面经里见‍‍‍‌‍‍‍‍‍‌‍‍‌‍‌‍‌‍‍过，给一个array，[1,3,2,3......8],还有一个query array[[1, 3, x]...] 代表从index 1 到 index 3 ，这个数字x 出现了多少次。题目有坑，用array解，别用treeset，有三个case过不去，最后几分钟才灵机一动改array了


onsite
1. 和一个founding eng聊‍‍‍‌‍‍‍‍‍‌‍‍‌‍‌‍‌‍‍项目
2. 给一个数组，找这个数组的某个区间使得区间的中位数最大，我也没想很清楚就不贴答案了
3. coding 写一个function来算input的mean max min等等，着重考察coding style。上了个厕所结果这轮没写完
4. system design，假设exchange有一个异步的API来post market order和查询order状态 要求做一个robinhood的交易功能，要求任何情况都不能挂。这轮被考到了，需要考虑exchange的API timeout和server crash的情况。面试官让你写实现功能的flow然后考虑哪一步会挂。主要是local db会有一个state，exchange那边会有一个state，在上述情况有可能out of sync。思路是先commit local db的transaction再去call exchange API，然后用aync job来verify和fix inconsitency
5. 代码题 leetcode LRU cache，  
6. robinhood有一个股票价格变动幅度5%就发一个push notification给关注这个股票的用户， 要求设计一个系统完成这个功‍‍‍‌‍‍‍‍‍‌‍‍‌‍‌‍‌‍‍能
hr反馈挂在系统设计上


【onsite】
4轮面试 早上一轮 下午三轮 
第一轮是manager 问背景 
后两轮就是专业知识加上coding
最后一轮是一个小project
总体来说对投的组的专业要求比较高 如果做过所投职位高度相关的project 一定要对每一个细节都很清楚 即使不是你做的部分 算法题不难 easy或者medium水平 利口calculator这个水平
专业技术要扎实 比如public key infrastructure里面的certificate 都有哪些fields 这些fields楼主还是功底比较扎实的 能说得很清楚 但是certificate有三个版本 支持option fields，被问到option fields还有如何试用option fields来解决一个实际问题 以及好一些在RFC里面的内容 如果没有专门做过相关的project还是比较不容易知道的知识

onsite
第一轮 写一个Android App，加载一个列表，每一行有一个timer count时间
第二轮 system design。设计一个message app for families。需要考虑产品功能，UI设计，API设计以及后台的Data Model
第三轮 白板 word breakII 简化版，只用打印出一个valid的结果就行
第四轮 implement Publisher Subscriber

‍‍‍‌‍‍‍‍‍‌‍‍‌‍‌‍‌‍‍onsite四轮
- hiring manager聊项目，需要你介绍项目背景的具体过程，会问一些问题
- 算法题。给问题，讲解体思路和分析时间空间复杂度，不需要写具体code。
- coding。电脑上写code，可以用ide。题目就是简单的模拟题。要求是写出可以提交到prod的代码，看你编程习惯，unit test之类的吧
- 系统设计。设计一个他们相关的系统。这轮答的不好。牵涉到transaction，
  预期是用database里的transaction的支持（他们用Postgres）。
  我没往这上面靠，自己加了一堆锁试图解决问题，但自己实现transaction太难了。
